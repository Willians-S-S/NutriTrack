@use 'sass:color';
@use '../../styles/variables.scss' as *;

.foods-page {
  padding: 32px;
  max-width: 900px;
  margin: 0 auto;

  h2 {
    font-size: 28px;
    font-weight: 600;
    color: $text-dark;
    margin: 0 0 16px 0;
  }

  /* ===== Busca ===== */
  .search {
    position: relative;
    margin-bottom: 18px;

    input {
      width: 100%;
      height: 44px;
      border: 1px solid rgba(0,0,0,0.12);
      border-radius: 8px;
      padding: 0 12px;
      font-size: 14px;
      outline: none;
      background: #fff;
      color: $text-dark;
      transition: box-shadow .15s ease, border-color .15s ease;

      &:focus {
        border-color: $primary-color;
        box-shadow: 0 0 0 3px rgba(39, 174, 96, 0.15);
      }
    }

    .results {
      position: absolute;
      z-index: 5;
      left: 0; right: 0; top: calc(100% + 6px);
      background: #fff;
      border: 1px solid rgba(0,0,0,0.08);
      box-shadow: $shadow;
      border-radius: 10px;
      padding: 6px;

      .result-row {
        width: 100%;
        text-align: left;
        padding: 10px 12px;
        border-radius: 8px;
        border: 0;
        background: transparent;
        cursor: pointer;
        color: $text-dark;
        font-size: 14px;

        &:hover { background: rgba(0,0,0,0.04); }
      }

      .empty {
        padding: 10px 12px;
        font-size: 14px;
        color: rgba(0,0,0,0.6);
      }
    }
  }

  /* ===== Refeições ===== */
  .meals {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .meal-card {
    background: #fff;
    border-radius: 12px;
    box-shadow: $shadow;
    border: 1px solid rgba(0,0,0,0.06);
    padding: 12px;

    .meal-title {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 4px 8px 8px;

      span:first-child {
        font-weight: 600;
        color: $text-dark;
        font-size: 14px;
      }

      .subkcal {
        font-size: 12px;
        color: rgba(0,0,0,0.55);
      }
    }

    .empty-cta {
      width: 100%;
      display: flex; align-items: center; justify-content: center;
      gap: 10px;
      padding: 14px 12px;
      background: #fafafa;
      border-radius: 8px;
      border: 1px dashed rgba(0,0,0,0.18);
      color: $text-dark;
      cursor: pointer;

      .plus {
        width: 24px; height: 24px; border-radius: 999px;
        background: $primary-color; color: white;
        display: inline-flex; align-items: center; justify-content: center;
        font-weight: 700;
      }
      &:hover { background: #f3f3f3; }
    }

    .food-list {
      list-style: none; padding: 0; margin: 0;
      display: flex; flex-direction: column; gap: 8px;

      .food-row {
        display: flex; align-items: center; justify-content: space-between;
        padding: 10px 12px;
        border-radius: 8px;
        background: #fafafa;
        border: 1px solid rgba(0,0,0,0.06);

        .left {
          display: flex; flex-direction: column; gap: 4px;

          .name { font-size: 15px; font-weight: 500; color: $text-dark; }
          .meta { font-size: 12px; color: rgba(0,0,0,0.55); }
        }

        .right.read-only .qty-tag {
          display: none; /* Removido o círculo de quantidade de porção */
        }

        .right.editing {
          display: inline-flex; align-items: center; gap: 8px;

          .counter {
            display: inline-flex; align-items: center; overflow: hidden;
            border: 1px solid rgba(0,0,0,0.12); border-radius: 8px; height: 36px;

            button {
              width: 36px; height: 36px; border: 0; background: #f4f4f4; cursor: pointer;
              font-size: 18px; /* Tamanho da fonte ajustado para ficar consistente com o nome dos alimentos */
            }
            .qty { display: inline-block; width: 36px; text-align: center; font-size: 15px; font-weight: 500; }
          }

          .remove-btn {
            width: 36px; height: 36px;
            border-radius: 8px; border: 1px solid rgba(0,0,0,0.12);
            background: #fff; cursor: pointer;
          }
        }
      }
    }

    .meal-actions {
      display: flex; justify-content: flex-end; gap: 10px; padding-top: 12px;

      /* Botões de Salvar e Editar */
      .save-btn,
      .edit-btn {
        height: 36px; /* Padronização da altura */
        padding: 0 14px;
        font-size: 14px; /* Padronização da fonte */
        border-radius: 6px; /* Borda arredondada */
        background-color: $primary-color; /* Cor verde (tom suave) */
        color: white; /* Texto branco */
        border: none; /* Sem borda preta */
        display: inline-flex;
        align-items: center;
        justify-content: center;
        text-align: center;

        &:hover {
          background-color: color.adjust($primary-color, $lightness: -10%); /* Usando adjust-color() ao invés de darken() */
        }
      }

      /* Botão de Cancelar */
      .ghost-btn {
        background-color: #e0e0e0; /* Fundo cinza claro */
        color: #616161; /* Texto cinza mais escuro */
        border: 1px solid #616161; /* Borda cinza escuro */
        border-radius: 6px; /* Borda arredondada */
        height: 36px; /* Padronização da altura */
        padding: 0 14px;
        font-size: 14px; /* Padronização da fonte */
        text-align: center;
        opacity: 0.7;
        transition: opacity 0.2s ease;

        &:hover {
          opacity: 1; /* Aumenta a opacidade ao passar o mouse */
        }
      }

      .save-btn.saved {
        background-color: #e5e5e5; /* Cor de fundo mais suave para 'salvo' */
        color: #333; /* Texto em cor mais escura */
      }

      .ghost-btn:hover {
        background-color: rgba(176, 176, 176, 0.2); /* Efeito de hover suave para o botão fantasma */
      }
    }
  }

  /* ===== Modal ===== */
  .modal-backdrop {
    position: fixed; inset: 0; background: rgba(0,0,0,0.3);
    display: grid; place-items: center; z-index: 50;
  }

  .modal {
    width: min(560px, 92vw);
    background: #fff; border-radius: 12px; box-shadow: $shadow; padding: 18px;

    .modal-head {
      display: flex; justify-content: space-between; align-items: center; gap: 8px;
      h3 { margin: 0; font-size: 20px; font-weight: 600; color: $text-dark; }
      .close-x { width: 36px; height: 36px; border-radius: 8px; border: 0; background: #f3f3f3; cursor: pointer; }
    }

    .modal-body {
      display: flex; flex-direction: column; gap: 16px; margin-top: 8px;

      .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
      @media (max-width: 560px) { .grid { grid-template-columns: 1fr; } }

      .row {
        display: grid; grid-template-columns: 100px 1fr; align-items: center; gap: 10px;

        label { font-size: 14px; color: rgba(0,0,0,0.7); }

        select {
          height: 44px; border-radius: 8px; border: 1px solid rgba(0,0,0,0.12);
          padding: 0 10px; outline: none;
          &:focus { border-color: $primary-color; box-shadow: 0 0 0 3px rgba(39,174,96,.15); }
        }

        .qty {
          display: inline-flex; align-items: center; height: 44px;
          border: 1px solid rgba(0,0,0,0.12); border-radius: 8px; overflow: hidden;

          button { width: 44px; height: 44px; border: 0; background: #f4f4f4; cursor: pointer; }
          input  { width: 64px; height: 44px; border: 0; text-align: center; outline: none; }
        }
      }

      .macros {
        display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 10px;
        @media (max-width: 560px) { grid-template-columns: repeat(2, minmax(0,1fr)); }

        .macro {
          background: #fafafa; border: 1px solid rgba(0,0,0,0.06); border-radius: 8px; padding: 10px 12px;
          .m-label { font-size: 12px; color: rgba(0,0,0,0.55); }
          .m-value { font-size: 14px; font-weight: 600; color: $text-dark; }
        }
      }

      .meal-select {
        display: flex; align-items: center; gap: 8px; flex-wrap: wrap;
        span { font-size: 14px; color: rgba(0,0,0,0.7); margin-right: 4px; }
        .pill {
          height: 34px; padding: 0 12px; border-radius: 999px;
          border: 1px solid rgba(0,0,0,0.12); background: #fff; cursor: pointer;
        }
        .pill.on { background: $primary-color; color: #fff; border-color: $primary-color; }
      }
    }

    .modal-actions {
      margin-top: 16px; display: flex; justify-content: flex-end; gap: 10px;
      .ghost-btn { height: 40px; padding: 0 14px; border-radius: 8px; border: 1px solid rgba(0,0,0,0.12); background: transparent; cursor: pointer; }
    }
  }
}
